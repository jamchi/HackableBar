<!doctype html>
<html lang="ja">

<head>
  <title>Hackable Bar</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link href="https://fonts.googleapis.com/css?family=Playfair+Display:300,400,700,800|Open+Sans:300,400,700"
    rel="stylesheet">

  <link rel="stylesheet" href="public/css/bootstrap.css">
  <link rel="stylesheet" href="public/css/animate.css">
  <link rel="stylesheet" href="public/css/owl.carousel.min.css">

  <link rel="stylesheet" href="public/css/magnific-popup.css">
  <link rel="stylesheet" href="public/css/aos.css">

  <link rel="stylesheet" href="public/css/bootstrap-datepicker.css">
  <link rel="stylesheet" href="public/css/jquery.timepicker.css">

  <link rel="stylesheet" href="fonts/ionicons/css/ionicons.min.css">
  <link rel="stylesheet" href="fonts/fontawesome/css/font-awesome.min.css">

  <link rel="stylesheet" href="fonts/flaticon/font/flaticon.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@900&display=swap" rel="stylesheet">

  <!-- Theme Style -->
  <link rel="stylesheet" href="public/css/style.css">
  <link rel="stylesheet" href="https://unpkg.com/swiper/css/swiper.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;900&display=swap" rel="stylesheet">
  <link
    href="https://fonts.googleapis.com/css2?family=Abril+Fatface&family=Fredericka+the+Great&family=Press+Start+2P&display=swap"
    rel="stylesheet">

  <script src="https://unpkg.com/ionicons@5.0.0/dist/ionicons.js"></script>
  <style>
    .swiper-container {
      width: 100%;
      padding-top: 120px;
      padding-bottom: 120px;
      height: 600px;
    }

    .swiper-slide {
      background-position: center;
      background-size: cover;
      width: 300px;
      height: 300px;
      -moz-transition: all 0.1s ease-in-out;
      -webkit-transition: all 0.1s ease-in-out;
      -o-transition: all 0.1s ease-in-out;
      transition: all 0.1s ease-in-out;
    }

    .swiper-slide.swiper-slide-active {
      width: 400px;
      height: 400px;
      margin-top: -50px;
      margin-left: -50px;
    }
  </style>
</head>

<body class="bg-light">

  <body data-spy="scroll" data-target="#ftco-navbar-spy" data-offset="0">

    <div class="site-wrap">

      <nav class="site-menu" id="ftco-navbar-spy">
        <div class="site-menu-inner" id="ftco-navbar">
          <ul class="list-unstyled">
            <li><a href="#section-home">Home</a></li>
            <li><a href="#section-about">About Us</a></li>
            <li><a href="#section-menu">Our Menu</a></li>
            <li><a href="#section-reservation">Reserve A Table</a></li>
            <li><a href="#section-contact">Contact</a></li>
          </ul>
        </div>
      </nav>

      <header class="site-header">
        <div class="row align-items-center">
          <div class="col-5 col-md-3">

          </div>
          <div class="col-2 col-md-6 text-center site-logo-wrap">
            <a href="index.html" class="site-logo">H</a>
          </div>
          <div class="col-5 col-md-3 text-right menu-burger-wrap">
            <a href="#" class="site-nav-toggle js-site-nav-toggle"><i></i></a>

          </div>
        </div>

      </header> <!-- site-header -->

      <div class="main-wrap " id="section-home">

        <div class="cover_1 overlay bg-light">
          <div class="img_bg" style="background-image: url(public/images/main_bg.jpg);"
            data-stellar-background-ratio="0.5">
            <div id="view_mode2" style="display: none;">
              <div class="view-container" style="position: absolute; top: 15%; right: 10%; bottom: 15%; left: 10%;">
                <h1 style="margin-bottom: 40px; font-size: 120px; color:#fff; font-family: 'Montserrat', sans-serif; text-shadow: 1px 1px 12px rgba(0,0,0,.2)">Today's Events</h1>
                <div id="events_1" style="display: inline-block; width: 49%; vertical-align: top;"></div>
                <div id="events_2" style="display: inline-block; width: 49%; vertical-align: top;"></div>
              </div>
            </div>
            <div class="container">
              <div id="cover_content" class="row align-items-center justify-content-center text-center">
                <div class="col-md-10" data-aos="fade-up">
                  <h1 class="heading mb-5" style="font-weight: normal;font-family: 'Press Start 2P';">The Hackable Bar
                  </h1>
                  <div style="display: flex;align-items: center;justify-content: center;">
                    <a style="display: flex;align-items: center;justify-content: center;width: 360px;"
                      href="https://github.com/publika/HackableBar" target="_blank"
                      class="smoothscroll btn btn-outline-white px-5 py-3">
                      <ion-icon style="font-size: 24px;" name="logo-github"></ion-icon>
                      <span
                        style="font-family: 'Press Start 2P', cursive; font-size: 13px;margin-top: 3px;display:
                        inline-block;margin-left: 12px;line-height: 15px;">Hack On Github</span>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div> <!-- .cover_1 -->

        <div class="section bg-white pt-2 pb-2 text-center" data-aos="fade">
          <div class="swiper-container">
            <div id="gallery" class="swiper-wrapper">
              
            </div>
            <!-- Add Pagination -->
            <div class="swiper-pagination"></div>
          </div>
        </div> <!-- .section -->

        <div class="section bg-light" id="section-menu" data-aos="fade-up">
          <div class="container">
            <div class="row section-heading justify-content-center mb-5">
              <div class="col-md-8 text-center">
                <h2 style="font-family: 'Fredericka the Great', cursive; font-weight: normal" class="heading mb-3">MENU</h2>
              </div>
            </div>
            <div class="row justify-content-center">
              <div class="col-md-8">
                <ul class="nav site-tab-nav" id="pills-tab" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link active" id="pills-breakfast-tab" data-toggle="pill" href="#pills-breakfast"
                      role="tab" aria-controls="pills-breakfast" aria-selected="true">Drinks</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" id="pills-lunch-tab" data-toggle="pill" href="#pills-lunch" role="tab"
                      aria-controls="pills-lunch" aria-selected="false">Foods</a>
                  </li>
                </ul>
                <div class="tab-content" id="pills-tabContent">

                </div>
              </div>

            </div>
          </div>
        </div> <!-- .section -->

        <div class="section bg-white" data-aos="fade-up">
          <div class="container">
            <div class="row mb-5">
              <div class="col-md-12 section-heading text-center">
                <h2 style="font-family: 'Fredericka the Great', cursive; font-weight: normal" class="heading mb-3">
                  BARTENDERS
                </h2>
              </div>
            </div>
            <div id="members" class="row">

            </div>
          </div>
        </div>
      </div>

      <!-- loader -->
      <div id="loader" class="show fullscreen"><svg class="circular" width="48px" height="48px">
          <circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee" />
          <circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10"
            stroke="#ff7a5c" /></svg></div>

      <script src="public/js/jquery-3.2.1.min.js"></script>
      <script src="public/js/jquery-migrate-3.0.1.min.js"></script>
      <script src="public/js/popper.min.js"></script>
      <script src="public/js/bootstrap.min.js"></script>
      <script src="public/js/owl.carousel.min.js"></script>
      <script src="public/js/jquery.waypoints.min.js"></script>

      <script src="public/js/bootstrap-datepicker.js"></script>
      <script src="public/js/jquery.timepicker.min.js"></script>
      <script src="public/js/jquery.stellar.min.js"></script>

      <script src="public/js/jquery.easing.1.3.js"></script>

      <script src="public/js/aos.js"></script>


      <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVWaKrjvy3MaE7SQ74_uJiULgl1JY0H2s&sensor=false">
      </script>

      <script src="public/js/main.js"></script>

      <script>
        $(function () {
          $.getJSON("/public/js/master.json", function (masterJSON) {
            let tabContentHTML = "";

            tabContentHTML = tabContentHTML +
              '<div class="tab-pane fade show active" id="pills-breakfast" role="tabpanel" aria-labelledby="pills-breakfast-tab">';

            masterJSON.drinks.map((drink) => {
              tabContentHTML = tabContentHTML + '<div class="d-block d-md-flex menu-food-item">' +
                '<div class="text order-1 mb-3">' +
                '<img style="height: 94px; object-fit: cover" src="' + drink.image_url + '" alt="Image">' +
                '<h3><a href="#">' + drink.name + '</a></h3>' +
                '<p style="font-size: 12px;">' + drink.description + '</p>' +
                '</div>' +
                '<div class="price order-2">' +
                '<strong>¥ ' + drink.price + '</strong>' +
                '</div>' +
                '</div>';
            })

            tabContentHTML = tabContentHTML + '</div>';

            tabContentHTML = tabContentHTML +
              '<div class="tab-pane fade" id="pills-lunch" role="tabpanel" aria-labelledby="pills-lunch-tab">';

            masterJSON.foods.map((food) => {
              tabContentHTML = tabContentHTML + '<div class="d-block d-md-flex menu-food-item">' +
                '<div class="text order-1 mb-3">' +
                '<img style="height: 94px; object-fit: cover" src="' + food.image_url + '" alt="Image">' +
                '<h3><a href="#">' + food.name + '</a></h3>' +
                '<p style="font-size: 12px;">' + food.description + '</p>' +
                '</div>' +
                '<div class="price order-2">' +
                '<strong>¥ ' + food.price + '</strong>' +
                '</div>' +
                '</div>'
            })

            tabContentHTML = tabContentHTML + '</div>';

            $('#pills-tabContent').html(tabContentHTML);

            masterJSON.photos.map((photo) => {
              $('#gallery').append('<div class="swiper-slide" style="background-image:url(' + photo.image_url + ')"></div>')
            })

            let viewMode = getUrlParameter('mode');

            if (viewMode == "2") {
              $('#cover_content').remove();
              $('#view_mode2').show();
              var todaySchedule = masterJSON.schedules.filter(function(item, index){
                if (item.date == getNowYMD()) return true;
              });
              let todayEvents = todaySchedule[0].events;
              let eventsHTML = '';
              
              todayEvents.map((event, index) => {
                let target = "";
                if (index < 4) { target = '#events_1' ; } else { target='#events_2' ; }

                $(target).append('<div id="event_' + index + '" class="Event"' + 
                  ' data-t="' + (Number(event.start_at.replace(':', '')) + event.duration) + '">' +
                  '<span class="pulse"></span>' +
                  `<h2 class="Event_time">` + event.start_at + `</h2>` +
                  `<h2 class="Event_title">` + event.title + `</h2>` +
                '</div>');

                setTimeout(function(){
                  $('#event_' + index).addClass('show')
                },1000*index);

              })
            }

            setInterval(function(){
              var goal = "2050";
              
              var times = [];
              $(".Event").each(function(event, elm) {
                times.push($(this).attr('data-t'));
              })

              var closest = times.reduce(function(prev, curr) {
                return (Math.abs(curr - goal) < Math.abs(prev - goal) ? curr : prev); 
              });

              $('.Event[data-t="' + closest + '"]').addClass('selected')
            },1000);

            masterJSON.members.map((member) => {
              $('#members').append('<div class="col-md-3 pr-md-5 text-center mb-5">' +
                '<div class="ftco-38">' +
                  '<div class="ftco-38-img">' +
                    '<div class="ftco-38-header">' +
                      '<img src="' + member.avatar_image_url + '" alt="Image">' +
                      '<h3 class="ftco-38-heading">' + member.name + '</h3>' +
                      '<p class="ftco-38-subheading">' + member.profession + '</p>' +
                    '</div>' +
                    '<div class="ftco-38-body">' +
                      '<p>' +
                        '<a href="' + member.github_url + '" class="p-2"><span class="fa fa-github"></span></a>' +
                        '<a href="' + member.twitter_url + '" class="p-2"><span class="fa fa-twitter"></span></a>' +
                        '<a href="' + member.facebook_url + '" class="p-2"><span class="fa fa-facebook"></span></a>' +
                      '</p>' +
                    '</div>' +
                  '</div>' +
                '</div>' +
              '</div>')
            })

            var swiper = new Swiper('.swiper-container', {
              effect: 'coverflow',
              grabCursor: true,
              centeredSlides: true,
              slidesPerView: 'auto',
              loop: true,
              coverflowEffect: {
                rotate: 20,
                stretch: 40,
                depth: 120,
                modifier: 1,
                slideShadows: true,
              }
            });
          });
        });

        function getNowYMD(){
          var dt = new Date();
          var y = dt.getFullYear();
          var m = ("00" + (dt.getMonth()+1)).slice(-2);
          var d = ("00" + dt.getDate()).slice(-2);
          var result = y + "-" + m + "-" + d;
          return result;
        }

    
        function getUrlParameter(sParam) {
          var sPageURL = window.location.search.substring(1),
          sURLVariables = sPageURL.split('&'),
          sParameterName,
          i;

          for (i = 0; i < sURLVariables.length; i++) { sParameterName=sURLVariables[i].split('=');
            if (sParameterName[0] === sParam) {
                return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
            }
          }
        };
      </script>

      <script src="https://unpkg.com/swiper/js/swiper.min.js"></script>
  </body>

</html>